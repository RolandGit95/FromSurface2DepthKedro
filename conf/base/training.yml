name: STLSTM
  
globals:
  wandb: True
  seed: 42
  max_epochs: 8
  
dataset:
  val_split: 0.1
  seed: "@/globals/seed"
  train: 
    type: BarkleyDataset
    X: {type: input_data}
    Y: {type: true_output_data}
    depths: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]
    time_steps: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]

  val: 
    type: BarkleyDataset
    X: {type: input_data}
    Y: {type: true_output_data}
    depths: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]
    time_steps: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]
  
dataloader:
  train:
    type: DataLoader
    dataset: "@/dataset/train"
    batch_size: 8
    num_workers: 4
    pin_memory: True
    drop_last: True    
    sampler:
      type: TrainSampler
      dataset_length: {type: method_call, obj: "@/dataset/train", method: __len__}
      val_split: "@/dataset/val_split"
      
  val:
    type: DataLoader
    dataset: "@/dataset/val"
    batch_size: 64
    num_workers: 4
    pin_memory: True
    drop_last: True    
    sampler:
      type: ValSampler
      dataset_length: {type: method_call, obj: "@/dataset/val", method: __len__}    
      val_split: "@/dataset/val_split"

model:
  type: STLSTM
  pretrained: False
  model_path: None
  depths: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]
  time_steps: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]
  hidden_size: 64
  
optimizer:
  type: AdamW
  params: {type: method_call, obj: "@/model", method: parameters}
  lr: 3.0e-4
  weight_decay: 1.0e-6
  
scheduler:
  type: ReduceLROnPlateau
  optimizer: "@/optimizer"
  mode: max
  factor: 0.2
  patience: 3
  min_lr: 1.0e-7  
  
loss: {type: MeanSquaredError}
